(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76],{1326:function(e,a,s){Promise.resolve().then(s.bind(s,8386))},8386:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return d}});var r=s(7437),l=s(2265),n=s(8643),t=s.n(n);function i(e){if(!e)return"—";try{return new Date(e).toLocaleString()}catch(a){return e}}function c(e){return e?({defensible_bet:"Defensible Bet",partial_clarity:"Partial Clarity",guessing:"Guessing"})[e]||e:"—"}function d(){var e,a,s,n,d,o,h;let[u,m]=(0,l.useState)(""),[j,x]=(0,l.useState)(""),[_,p]=(0,l.useState)(!1),[w,N]=(0,l.useState)({inquiriesTotal:0,scorecardTotal:0,byTier:{}}),[b,v]=(0,l.useState)({items:[],total:0}),[g,f]=(0,l.useState)({items:[],total:0}),[y,L]=(0,l.useState)(""),[k,C]=(0,l.useState)(null),[S,T]=(0,l.useState)(null),[V,E]=(0,l.useState)(""),R=(0,l.useCallback)(async()=>{let e=await fetch("/api/internal/stats",{credentials:"include"});e.ok&&N(await e.json())},[]),I=(0,l.useCallback)(async()=>{let e=new URLSearchParams({perPage:"20",sort:"-created"});y&&e.set("email",y);let a=await fetch("/api/internal/inquiries?".concat(e),{credentials:"include"});a.ok?v(await a.json()):v({items:[],total:0})},[y]),P=(0,l.useCallback)(async()=>{let e=new URLSearchParams({perPage:"20",sort:"-created"});y&&e.set("email",y);let a=await fetch("/api/internal/scorecard-submissions?".concat(e),{credentials:"include"});a.ok?f(await a.json()):f({items:[],total:0})},[y]);async function q(e){e.preventDefault(),x("");let a=await fetch("/api/internal/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:u}),credentials:"include"}),s=await a.json().catch(()=>({}));s.ok?p(!0):x(s.error||"Invalid password.")}async function O(){await fetch("/api/internal/auth",{method:"DELETE",credentials:"include"}),p(!1),C(null)}return((0,l.useEffect)(()=>{_&&(R(),I(),P(),fetch("/api/internal/pb-base",{credentials:"include"}).then(e=>e.ok&&e.json()).then(e=>e&&E(e.url||"")))},[_,R,I,P]),(0,l.useEffect)(()=>{if(!_)return;let e=setTimeout(()=>{I(),P()},300);return()=>clearTimeout(e)},[_,y,I,P]),_)?(0,r.jsxs)("div",{className:t().page,children:[(0,r.jsxs)("div",{className:t().container,children:[(0,r.jsx)("h1",{className:t().title,children:"Internal"}),(0,r.jsx)("p",{className:t().logout,children:(0,r.jsx)("button",{type:"button",onClick:O,children:"Log out"})}),(0,r.jsxs)("section",{className:t().stats,children:[(0,r.jsxs)("div",{className:t().statCard,children:[(0,r.jsx)("div",{className:t().statValue,children:w.inquiriesTotal}),(0,r.jsx)("div",{className:t().statLabel,children:"Inquiries"})]}),(0,r.jsxs)("div",{className:t().statCard,children:[(0,r.jsx)("div",{className:t().statValue,children:w.scorecardTotal}),(0,r.jsx)("div",{className:t().statLabel,children:"Scorecard submissions"})]}),(0,r.jsxs)("div",{className:t().statCard,children:[(0,r.jsx)("div",{className:t().statValue,children:null!==(n=null===(e=w.byTier)||void 0===e?void 0:e.defensible_bet)&&void 0!==n?n:0}),(0,r.jsx)("div",{className:t().statLabel,children:"Defensible Bet"})]}),(0,r.jsxs)("div",{className:t().statCard,children:[(0,r.jsx)("div",{className:t().statValue,children:null!==(d=null===(a=w.byTier)||void 0===a?void 0:a.partial_clarity)&&void 0!==d?d:0}),(0,r.jsx)("div",{className:t().statLabel,children:"Partial Clarity"})]}),(0,r.jsxs)("div",{className:t().statCard,children:[(0,r.jsx)("div",{className:t().statValue,children:null!==(o=null===(s=w.byTier)||void 0===s?void 0:s.guessing)&&void 0!==o?o:0}),(0,r.jsx)("div",{className:t().statLabel,children:"Guessing"})]})]}),(0,r.jsxs)("section",{className:t().searchWrap,children:[(0,r.jsx)("label",{className:t().gateLabel,children:"Search by email"}),(0,r.jsx)("input",{type:"text",className:t().searchInput,placeholder:"email@example.com",value:y,onChange:e=>L(e.target.value)})]}),(0,r.jsx)("h2",{className:t().sectionTitle,children:"Recent inquiries"}),(0,r.jsx)("div",{className:t().tableWrap,children:(0,r.jsxs)("table",{className:t().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Email"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Created"})]})}),(0,r.jsxs)("tbody",{children:[0===b.items.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:t().empty,children:"No inquiries found."})}),b.items.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("button",{type:"button",className:t().rowLink,onClick:()=>{T("inquiry"),C(e)},children:e.email})}),(0,r.jsx)("td",{children:e.name||"—"}),(0,r.jsx)("td",{children:e.status||"—"}),(0,r.jsx)("td",{children:i(e.created)})]},e.id))]})]})}),(0,r.jsx)("h2",{className:t().sectionTitle,children:"Recent scorecard submissions"}),(0,r.jsx)("div",{className:t().tableWrap,children:(0,r.jsxs)("table",{className:t().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Email"}),(0,r.jsx)("th",{children:"Score"}),(0,r.jsx)("th",{children:"Tier"}),(0,r.jsx)("th",{children:"Created"})]})}),(0,r.jsxs)("tbody",{children:[0===g.items.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:t().empty,children:"No submissions found."})}),g.items.map(e=>{var a;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("button",{type:"button",className:t().rowLink,onClick:()=>{T("scorecard"),C(e)},children:e.email})}),(0,r.jsx)("td",{children:null!==(a=e.score_total)&&void 0!==a?a:"—"}),(0,r.jsx)("td",{children:c(e.tier)}),(0,r.jsx)("td",{children:i(e.created)})]},e.id)})]})]})})]}),k&&(0,r.jsx)("div",{className:t().overlay,onClick:()=>C(null),role:"dialog","aria-modal":"true",children:(0,r.jsxs)("div",{className:t().drawer,onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("h3",{className:t().drawerTitle,children:"inquiry"===S?"Inquiry":"Scorecard submission"}),"inquiry"===S&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Email"}),(0,r.jsx)("span",{className:t().drawerValue,children:k.email})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Name"}),(0,r.jsx)("span",{className:t().drawerValue,children:k.name||"—"})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Message"}),(0,r.jsx)("span",{className:t().drawerValue,children:k.message||"—"})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Status"}),(0,r.jsx)("span",{className:t().drawerValue,children:k.status||"—"})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Created"}),(0,r.jsx)("span",{className:t().drawerValue,children:i(k.created)})]}),V&&(0,r.jsx)("a",{href:"".concat(V,"/_/collections/inquiries/records/").concat(k.id),target:"_blank",rel:"noopener noreferrer",className:t().drawerLink,children:"Open in PocketBase admin →"})]}),"scorecard"===S&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Email"}),(0,r.jsx)("span",{className:t().drawerValue,children:k.email})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Score"}),(0,r.jsx)("span",{className:t().drawerValue,children:null!==(h=k.score_total)&&void 0!==h?h:"—"})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Tier"}),(0,r.jsx)("span",{className:t().drawerValue,children:c(k.tier)})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Answers"}),(0,r.jsx)("span",{className:t().drawerValue,children:Array.isArray(k.answers)?k.answers.join(", "):JSON.stringify(k.answers||"—")})]}),(0,r.jsxs)("div",{className:t().drawerRow,children:[(0,r.jsx)("span",{className:t().drawerLabel,children:"Created"}),(0,r.jsx)("span",{className:t().drawerValue,children:i(k.created)})]}),V&&(0,r.jsx)("a",{href:"".concat(V,"/_/collections/scorecard_submissions/records/").concat(k.id),target:"_blank",rel:"noopener noreferrer",className:t().drawerLink,children:"Open in PocketBase admin →"})]}),(0,r.jsx)("button",{type:"button",className:t().drawerClose,onClick:()=>C(null),children:"Close"})]})})]}):(0,r.jsx)("div",{className:t().page,children:(0,r.jsx)("div",{className:t().container,children:(0,r.jsxs)("div",{className:t().gate,children:[(0,r.jsx)("h1",{className:t().title,children:"Internal"}),(0,r.jsxs)("form",{onSubmit:q,children:[(0,r.jsx)("label",{className:t().gateLabel,children:"Password"}),(0,r.jsx)("input",{type:"password",className:t().gateInput,value:u,onChange:e=>m(e.target.value),autoComplete:"current-password",autoFocus:!0}),(0,r.jsx)("button",{type:"submit",className:t().gateBtn,children:"Log in"}),j&&(0,r.jsx)("p",{className:t().gateError,children:j})]})]})})})}},8643:function(e){e.exports={page:"internal_page__mSRkM",container:"internal_container___PVJO",title:"internal_title__iDkR_",gate:"internal_gate__ip7Qo",gateLabel:"internal_gateLabel__zMmor",gateInput:"internal_gateInput__QMIef",gateBtn:"internal_gateBtn__bF35i",gateError:"internal_gateError__HHHtM",logout:"internal_logout__KEz9o",stats:"internal_stats__VkE_j",statCard:"internal_statCard__e5pv_",statValue:"internal_statValue__xzgFO",statLabel:"internal_statLabel__4vIUd",searchWrap:"internal_searchWrap__KONdN",searchInput:"internal_searchInput__CLjWh",sectionTitle:"internal_sectionTitle___eqnS",tableWrap:"internal_tableWrap__9z2Zy",table:"internal_table__aJsgO",rowLink:"internal_rowLink__Veps6",overlay:"internal_overlay__VT8JS",drawer:"internal_drawer__9noEV",drawerTitle:"internal_drawerTitle__TXo3i",drawerRow:"internal_drawerRow__zmGzU",drawerLabel:"internal_drawerLabel__9jFtA",drawerValue:"internal_drawerValue__QfziX",drawerLink:"internal_drawerLink__DfFF_",drawerClose:"internal_drawerClose__9Tgvp",empty:"internal_empty__wcYj5"}}},function(e){e.O(0,[891,971,117,744],function(){return e(e.s=1326)}),_N_E=e.O()}]);